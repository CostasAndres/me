# üöÄ Despliegue en Cloudflare Pages - Portfolio Andr√©s Costas Moreno

<style>
/* Estilos para la documentaci√≥n */
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  line-height: 1.6;
  color: #333;
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
  background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
}

/* Encabezados */
h1 {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 20px;
  border-radius: 10px;
  text-align: center;
  font-size: 2.5em;
  margin-bottom: 30px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

h2 {
  color: #2c3e50;
  border-left: 4px solid #667eea;
  padding-left: 15px;
  margin-top: 40px;
  margin-bottom: 20px;
  font-size: 1.8em;
}

h3 {
  color: #34495e;
  margin-top: 25px;
  margin-bottom: 15px;
  font-size: 1.4em;
}

/* Contenedores de informaci√≥n */
.info-box {
  background: white;
  border-radius: 10px;
  padding: 20px;
  margin: 20px 0;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  border-left: 4px solid #3498db;
}

.warning-box {
  background: #fff3cd;
  border: 1px solid #ffeaa7;
  border-radius: 10px;
  padding: 15px;
  margin: 15px 0;
  border-left: 4px solid #f39c12;
}

.success-box {
  background: #d4edda;
  border: 1px solid #c3e6cb;
  border-radius: 10px;
  padding: 15px;
  margin: 15px 0;
  border-left: 4px solid #28a745;
}

.error-box {
  background: #f8d7da;
  border: 1px solid #f5c6cb;
  border-radius: 10px;
  padding: 15px;
  margin: 15px 0;
  border-left: 4px solid #dc3545;
}

/* Bloques de c√≥digo */
pre {
  background: #2c3e50;
  color: #ecf0f1;
  padding: 20px;
  border-radius: 8px;
  overflow-x: auto;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  line-height: 1.4;
  margin: 15px 0;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

code {
  background: #f8f9fa;
  color: #e74c3c;
  padding: 2px 6px;
  border-radius: 4px;
  font-family: 'Courier New', monospace;
  font-size: 0.9em;
}

/* Listas */
ul, ol {
  padding-left: 25px;
}

li {
  margin: 8px 0;
}

/* Enlaces */
a {
  color: #3498db;
  text-decoration: none;
  transition: color 0.3s ease;
}

a:hover {
  color: #2980b9;
  text-decoration: underline;
}

/* Botones */
.btn {
  display: inline-block;
  padding: 10px 20px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  text-decoration: none;
  border-radius: 5px;
  margin: 5px;
  transition: transform 0.3s ease;
}

.btn:hover {
  transform: translateY(-2px);
  color: white;
  text-decoration: none;
}

/* Tablas */
table {
  width: 100%;
  border-collapse: collapse;
  margin: 20px 0;
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

th, td {
  padding: 12px;
  text-align: left;
  border-bottom: 1px solid #ddd;
}

th {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  font-weight: 600;
}

tr:hover {
  background: #f8f9fa;
}

/* Iconos */
.icon {
  font-size: 1.2em;
  margin-right: 8px;
}

/* Badges */
.badge {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 0.8em;
  font-weight: bold;
  margin: 2px;
}

.badge-success {
  background: #28a745;
  color: white;
}

.badge-warning {
  background: #ffc107;
  color: #212529;
}

.badge-info {
  background: #17a2b8;
  color: white;
}

/* Estructura de archivos */
.file-tree {
  background: #f8f9fa;
  border: 1px solid #dee2e6;
  border-radius: 8px;
  padding: 20px;
  font-family: 'Courier New', monospace;
  margin: 15px 0;
}

/* Responsive */
@media (max-width: 768px) {
  body {
    padding: 10px;
  }
  
  h1 {
    font-size: 2em;
  }
  
  pre {
    font-size: 12px;
    padding: 15px;
  }
}
</style>

## üìã Resumen
Este documento describe el proceso completo para desplegar una aplicaci√≥n Next.js en Cloudflare Pages, incluyendo la configuraci√≥n, optimizaci√≥n y despliegue.

<div class="info-box">
  <strong>üéØ Objetivo:</strong> Desplegar un portfolio personal en Cloudflare Pages con Next.js
</div>

## üîß Prerrequisitos
- <span class="badge badge-info">Node.js 18+</span> instalado
- <span class="badge badge-info">Cuenta en Cloudflare</span>
- <span class="badge badge-info">C√≥digo en GitHub</span> (recomendado)
- <span class="badge badge-info">Wrangler CLI</span> instalado

## üì¶ Instalaci√≥n de Wrangler CLI
```bash
npm install -g wrangler
```

## üîê Autenticaci√≥n en Cloudflare
```bash
wrangler login
```

## ‚öôÔ∏è Configuraci√≥n del Proyecto

### 1. Configuraci√≥n de Next.js para Cloudflare Pages

#### Archivo: `next.config.ts`
```typescript
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  // Configuraci√≥n de im√°genes
  images: {
    formats: ['image/webp', 'image/avif'],
    deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],
    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],
    remotePatterns: [
      {
        protocol: 'https',
        hostname: 'avatars.githubusercontent.com',
        port: '',
        pathname: '/u/**',
      },
    ],
    unoptimized: true, // Necesario para output: export
  },
  
  // Headers de seguridad
  async headers() {
    return [
      {
        source: '/(.*)',
        headers: [
          {
            key: 'X-Frame-Options',
            value: 'DENY',
          },
          {
            key: 'X-Content-Type-Options',
            value: 'nosniff',
          },
          {
            key: 'Referrer-Policy',
            value: 'origin-when-cross-origin',
          },
        ],
      },
    ];
  },
  
  // Configuraci√≥n de compresi√≥n
  compress: true,
  
  // Configuraci√≥n para Cloudflare Pages
  output: 'export', // Exporta archivos est√°ticos
  trailingSlash: true,
};

export default nextConfig;
```

#### Archivo: `src/app/sitemap.ts`
```typescript
import { MetadataRoute } from 'next'

export const dynamic = 'force-static' // Necesario para output: export

export default function sitemap(): MetadataRoute.Sitemap {
  const baseUrl = 'https://andres-costas.com' // Cambia esto por tu dominio real
  
  return [
    {
      url: baseUrl,
      lastModified: new Date(),
      changeFrequency: 'monthly',
      priority: 1,
    },
    // ... m√°s URLs
  ]
}
```

#### Archivo: `src/app/robots.ts`
```typescript
import { MetadataRoute } from 'next'

export const dynamic = 'force-static' // Necesario para output: export

export default function robots(): MetadataRoute.Robots {
  const baseUrl = 'https://andres-costas.com' // Cambia esto por tu dominio real
  
  return {
    rules: {
      userAgent: '*',
      allow: '/',
      disallow: ['/private/', '/admin/'],
    },
    sitemap: `${baseUrl}/sitemap.xml`,
  }
}
```

### 2. Configuraci√≥n de Wrangler

#### Archivo: `wrangler.toml`
```toml
name = "portfolio"
compatibility_date = "2024-01-01"

[pages]
name = "portfolio"
compatibility_date = "2024-01-01"
pages_build_output_dir = "out"
```

## üöÄ Proceso de Despliegue

### 1. Construir la aplicaci√≥n
```bash
npm run build
```

<div class="info-box">
  <strong>üìù Este comando:</strong>
  <ul>
    <li>Compila la aplicaci√≥n Next.js</li>
    <li>Genera archivos est√°ticos en el directorio <code>out/</code></li>
    <li>Optimiza im√°genes y assets</li>
    <li>Crea sitemap.xml y robots.txt</li>
  </ul>
</div>

### 2. Desplegar en Cloudflare Pages
```bash
wrangler pages deploy out --project-name=portfolio
```

<div class="info-box">
  <strong>üìù Este comando:</strong>
  <ul>
    <li>Sube los archivos est√°ticos a Cloudflare Pages</li>
    <li>Crea un nuevo proyecto si no existe</li>
    <li>Genera una URL temporal para el despliegue</li>
  </ul>
</div>

### 3. Resultado del despliegue
```bash
‚ú® Success! Uploaded 42 files (3.32 sec)
üåé Deploying...
‚ú® Deployment complete! Take a peek over at https://5ec12b5c.portfolio-4j3.pages.dev
```

<div class="success-box">
  <strong>‚úÖ ¬°Despliegue exitoso!</strong> Tu aplicaci√≥n est√° ahora disponible en la URL proporcionada.
</div>

## üåê Configuraci√≥n de Dominio Personalizado

### Opci√≥n 1: Desde el Dashboard de Cloudflare <span class="badge badge-success">Recomendado</span>

1. **Ir al Dashboard de Cloudflare Pages**
   - <a href="https://dash.cloudflare.com/?to=/:account/pages" class="btn">Abrir Dashboard</a>
   - Seleccionar proyecto `portfolio`

2. **Configurar dominio personalizado**
   - Ir a "Custom domains"
   - Hacer clic en "Set up a custom domain"
   - Escribir: `andrescosta.dev`
   - Hacer clic en "Continue"

3. **Verificar configuraci√≥n**
   - Cloudflare autom√°ticamente configura los registros DNS
   - El dominio estar√° disponible en unos minutos

### Opci√≥n 2: Configurar DNS manualmente

1. **Ir a la secci√≥n DNS**
   - Dashboard de Cloudflare ‚Üí Tu dominio ‚Üí DNS

2. **Agregar registro CNAME**

| Campo | Valor |
|-------|-------|
| **Type** | CNAME |
| **Name** | `@` (o vac√≠o para dominio ra√≠z) |
| **Target** | `5ec12b5c.portfolio-4j3.pages.dev` |
| **Proxy status** | Proxied (nube naranja) |

## üîÑ Actualizaci√≥n del Sitio

### Para actualizar despu√©s de cambios:
```bash
# 1. Hacer cambios en el c√≥digo
# 2. Construir la aplicaci√≥n
npm run build

# 3. Desplegar
wrangler pages deploy out --project-name=portfolio
```

### Para actualizaci√≥n autom√°tica desde GitHub:
1. Conectar repositorio en Cloudflare Pages
2. Configurar build autom√°tico
3. Cada push a GitHub actualiza autom√°ticamente el sitio

<div class="info-box">
  <strong>üí° Pro tip:</strong> La actualizaci√≥n autom√°tica desde GitHub es la forma m√°s eficiente de mantener tu sitio actualizado.
</div>

## üõ†Ô∏è Comandos √ötiles

### Ver informaci√≥n del proyecto
```bash
wrangler whoami
```

### Ver deployments
```bash
wrangler pages deployment list --project-name=portfolio
```

### Descargar configuraci√≥n
```bash
wrangler pages download --project-name=portfolio
```

## ‚ùó Soluci√≥n de Problemas

### Error: "Pages only supports files up to 25 MiB in size"
<div class="error-box">
  <strong>üîß Soluci√≥n:</strong> Usar <code>output: 'export'</code> en next.config.ts para generar archivos est√°ticos m√°s peque√±os.
</div>

### Error: "export const dynamic = 'force-static' not configured"
<div class="error-box">
  <strong>üîß Soluci√≥n:</strong> Agregar <code>export const dynamic = 'force-static'</code> en archivos de API routes.
</div>

### Error: "headers will not automatically work with output: export"
<div class="warning-box">
  <strong>‚ö†Ô∏è Nota:</strong> Los headers se configuran en Cloudflare Pages, no en Next.js.
</div>

## ‚ú® Ventajas de Cloudflare Pages

| Caracter√≠stica | Beneficio |
|----------------|-----------|
| <span class="badge badge-success">Gratis</span> | 500 builds por mes |
| <span class="badge badge-success">R√°pido</span> | CDN global de Cloudflare |
| <span class="badge badge-success">Autom√°tico</span> | Se actualiza con cada push a GitHub |
| <span class="badge badge-success">Optimizado</span> | Maneja autom√°ticamente Next.js |
| <span class="badge badge-success">SSL</span> | Certificado HTTPS autom√°tico |
| <span class="badge badge-success">Seguro</span> | Protecci√≥n DDoS incluida |

## üîó URLs del Proyecto

- **Despliegue temporal**: <a href="https://5ec12b5c.portfolio-4j3.pages.dev" class="btn">Ver sitio</a>
- **Dominio personalizado**: <a href="https://andrescosta.dev" class="btn">andrescosta.dev</a> (configurado)
- **Dashboard**: <a href="https://dash.cloudflare.com/?to=/:account/pages" class="btn">Abrir Dashboard</a>

## üìÅ Estructura de Archivos

<div class="file-tree">
me/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sitemap.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ robots.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ components/
‚îú‚îÄ‚îÄ out/                    # Archivos est√°ticos generados
‚îú‚îÄ‚îÄ next.config.ts         # Configuraci√≥n de Next.js
‚îú‚îÄ‚îÄ wrangler.toml          # Configuraci√≥n de Wrangler
‚îî‚îÄ‚îÄ package.json
</div>

## üìù Notas Importantes

<div class="warning-box">
  <strong>‚ö†Ô∏è Configuraciones cr√≠ticas:</strong>
  <ul>
    <li><code>output: 'export'</code>: Necesario para generar archivos est√°ticos</li>
    <li><code>unoptimized: true</code>: Para im√°genes en export</li>
    <li><code>dynamic: 'force-static'</code>: Para API routes en export</li>
    <li><code>trailingSlash: true</code>: Para compatibilidad con Cloudflare Pages</li>
  </ul>
</div>

## üìö Recursos Adicionales

- <a href="https://developers.cloudflare.com/pages/" class="btn">Documentaci√≥n de Cloudflare Pages</a>
- <a href="https://nextjs.org/docs/app/building-your-application/deploying/static-exports" class="btn">Next.js Static Export</a>
- <a href="https://developers.cloudflare.com/workers/wrangler/" class="btn">Wrangler CLI</a>

---

<div class="info-box">
  <strong>üìÖ Fecha de creaci√≥n:</strong> 22 de Julio, 2025<br>
  <strong>üë®‚Äçüíª Autor:</strong> Andr√©s Costas Moreno<br>
  <strong>üìÑ Versi√≥n:</strong> 1.0
</div> 